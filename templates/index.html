<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <link rel="apple-touch-icon" sizes="180x180" href="/static/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/static/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/static/favicon/favicon-16x16.png">
  <link rel="shortcut icon" href="/static/favicon/favicon.ico">
  <meta name="theme-color" content="#080A0F">
  <title>IMPORT ‚Äî –ü—Ä–µ–º–∏—É–º –∑–∞–ø—á–∞—Å—Ç–∏</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;0,600;1,300&family=JetBrains+Mono:wght@500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg:#080A0F; --bg-2:#0D1017; --bg-3:#12161E;
      --surface:#161B24; --surface-2:#1E2533;
      --border:rgba(255,255,255,0.06); --border-hover:rgba(255,255,255,0.12);
      --text:#F0F2F5; --text-2:#8B92A5; --text-3:#4E5568;
      --accent:#00D4FF; --accent-dim:rgba(0,212,255,0.12); --accent-glow:rgba(0,212,255,0.25);
      --green:#00E5A0; --green-dim:rgba(0,229,160,0.12);
      --red:#FF4757; --red-dim:rgba(255,71,87,0.12);
      --amber:#FFB020;
      --shadow:0 4px 16px rgba(0,0,0,0.5); --shadow-lg:0 12px 40px rgba(0,0,0,0.6);
      --radius:10px; --radius-lg:16px; --radius-xl:24px;
      --font-d:'Syne',sans-serif; --font-b:'DM Sans',sans-serif;
      --ease:cubic-bezier(0.16,1,0.3,1); --ease-f:cubic-bezier(0.4,0,0.2,1);
    }
    *,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{font-family:var(--font-b);background:var(--bg);color:var(--text);line-height:1.6;min-height:100vh;display:flex;flex-direction:column;-webkit-font-smoothing:antialiased;overflow-x:hidden}
    body::before{content:'';position:fixed;inset:0;background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E");pointer-events:none;z-index:9999;opacity:.4}
    .container{max-width:1280px;margin:0 auto;padding:0 1.5rem}
    ::-webkit-scrollbar{width:6px} ::-webkit-scrollbar-track{background:var(--bg-2)} ::-webkit-scrollbar-thumb{background:var(--surface-2);border-radius:3px}

    /* Header */
    .header{position:fixed;top:0;left:0;right:0;background:rgba(8,10,15,0.85);backdrop-filter:blur(20px) saturate(1.4);border-bottom:1px solid var(--border);z-index:200}
    .header-inner{display:flex;align-items:center;justify-content:space-between;height:64px;gap:2rem}
    .logo{display:flex;align-items:center;gap:10px;font-family:var(--font-d);font-size:1.25rem;font-weight:700;color:var(--text);text-decoration:none;letter-spacing:-.02em}
    .logo-mark{width:32px;height:32px;display:flex;align-items:center;justify-content:center;font-size:20px;position:relative}
    .logo-mark::after{content:'‚ö°';position:absolute;background:linear-gradient(135deg,#FFD700 0%,#FFA500 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;filter:drop-shadow(0 0 8px rgba(255,215,0,.4))}
    .logo-text span{color:var(--accent)}
    .nav{display:flex;align-items:center;gap:.25rem}
    .nav-link{font-size:.875rem;font-weight:500;color:var(--text-2);text-decoration:none;padding:.5rem .875rem;border-radius:6px;transition:all .2s var(--ease-f)}
    .nav-link:hover{color:var(--text);background:rgba(255,255,255,.05)}
    .nav-link.active{color:var(--accent);background:var(--accent-dim)}
    .header-actions{display:flex;align-items:center;gap:.75rem}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:.5rem;padding:.625rem 1.25rem;font-family:var(--font-b);font-size:.875rem;font-weight:600;border-radius:var(--radius);border:none;cursor:pointer;text-decoration:none;transition:all .2s var(--ease-f);white-space:nowrap;position:relative;overflow:hidden}
    .btn-primary{background:var(--accent);color:#080A0F;font-weight:700;box-shadow:0 0 20px var(--accent-glow)}
    .btn-primary:hover{transform:translateY(-1px);box-shadow:0 0 30px rgba(0,212,255,.4)}
    .btn-ghost{background:transparent;color:var(--text-2);border:1px solid var(--border)}
    .btn-ghost:hover{color:var(--text);border-color:var(--border-hover);background:rgba(255,255,255,.04)}
    .btn-lg{padding:.875rem 2.25rem;font-size:1rem}
    .btn-sm{padding:.375rem .875rem;font-size:.8125rem}
    .cart-btn{position:relative;padding:.625rem 1.25rem !important}
    .cart-count{position:absolute;top:-8px;right:-8px;background:var(--red);color:white;font-size:.6875rem;font-weight:700;min-width:18px;height:18px;border-radius:9px;padding:0 4px;display:none;align-items:center;justify-content:center;box-shadow:0 2px 8px rgba(255,71,87,.4)}

    /* Hero */
    .hero{padding-top:7rem;padding-bottom:5rem;position:relative;overflow:hidden}
    .hero-bg{position:absolute;inset:0;pointer-events:none}
    .hero-glow-1{position:absolute;top:-200px;left:50%;transform:translateX(-50%);width:800px;height:600px;background:radial-gradient(ellipse,rgba(0,212,255,.08) 0%,transparent 70%)}
    .hero-glow-2{position:absolute;bottom:-100px;right:-200px;width:500px;height:400px;background:radial-gradient(ellipse,rgba(0,229,160,.05) 0%,transparent 70%)}
    .hero-grid{position:absolute;inset:0;background-image:linear-gradient(rgba(255,255,255,.02) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,.02) 1px,transparent 1px);background-size:60px 60px;mask-image:radial-gradient(ellipse 80% 80% at 50% 50%,black 40%,transparent 100%)}
    .hero-content{text-align:center;max-width:800px;margin:0 auto;position:relative;z-index:1}
    .hero-eyebrow{display:inline-flex;align-items:center;gap:.5rem;font-size:.8125rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;color:var(--accent);margin-bottom:1.5rem;padding:.375rem 1rem;background:var(--accent-dim);border:1px solid rgba(0,212,255,.2);border-radius:100px;animation:fadeUp .6s var(--ease) both}
    .hero-title{font-family:var(--font-d);font-size:clamp(2.5rem,6vw,4.5rem);font-weight:800;letter-spacing:-.04em;line-height:1.05;margin-bottom:1.5rem;animation:fadeUp .6s .1s var(--ease) both}
    .hero-title .accent{color:var(--accent)}
    .hero-desc{font-size:1.125rem;color:var(--text-2);max-width:560px;margin:0 auto 2.5rem;line-height:1.7;animation:fadeUp .6s .2s var(--ease) both}
    .hero-actions{display:flex;align-items:center;justify-content:center;gap:1rem;flex-wrap:wrap;animation:fadeUp .6s .3s var(--ease) both}
    .hero-stats{display:flex;align-items:center;justify-content:center;gap:3rem;margin-top:4rem;padding-top:3rem;border-top:1px solid var(--border);animation:fadeUp .6s .4s var(--ease) both;flex-wrap:wrap}
    .hero-stat-val{font-family:'JetBrains Mono',monospace;font-size:2rem;font-weight:700;color:var(--text);display:block;letter-spacing:-.01em}
    .hero-stat-label{font-size:.8125rem;color:var(--text-2);margin-top:.125rem}
    @keyframes fadeUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}

    /* Products section */
    .section{padding:5rem 0}
    .section-header{display:flex;align-items:flex-end;justify-content:space-between;margin-bottom:2.5rem;gap:1rem;flex-wrap:wrap}
    .section-tag{font-size:.75rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;color:var(--accent);margin-bottom:.5rem}
    .section-title{font-family:var(--font-d);font-size:2rem;font-weight:800;letter-spacing:-.03em}
    .products-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(270px,1fr));gap:1.25rem}
    .product-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-lg);overflow:hidden;transition:all .3s var(--ease);display:flex;flex-direction:column}
    .product-card:hover{border-color:rgba(0,212,255,.2);transform:translateY(-4px);box-shadow:0 12px 40px rgba(0,0,0,.5)}
    .product-img{width:100%;height:210px;background:var(--bg-3);display:flex;align-items:center;justify-content:center;font-size:3.5rem;overflow:hidden;border-bottom:1px solid var(--border)}
    .product-img img{width:100%;height:100%;object-fit:cover}
    .product-body{padding:1.25rem;flex:1;display:flex;flex-direction:column}
    .product-cat{font-size:.75rem;font-weight:700;letter-spacing:.06em;text-transform:uppercase;color:var(--accent);margin-bottom:.375rem}
    .product-name{font-family:var(--font-d);font-size:1rem;font-weight:700;margin-bottom:.5rem;line-height:1.3}
    .product-desc{font-size:.8125rem;color:var(--text-2);line-height:1.5;flex:1;margin-bottom:1rem;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
    .product-footer{display:flex;align-items:center;justify-content:space-between;gap:.5rem;margin-top:auto}
    .product-price{font-family:'JetBrains Mono',monospace;font-size:1.25rem;font-weight:700;letter-spacing:-.01em}
    .add-btn{padding:.5rem 1rem;background:var(--accent);color:#080A0F;border:none;border-radius:var(--radius);cursor:pointer;font-family:var(--font-b);font-size:.8125rem;font-weight:700;transition:all .2s}
    .add-btn:hover{box-shadow:0 0 16px var(--accent-glow);transform:scale(1.03)}
    .add-btn:disabled{background:var(--surface-2);color:var(--text-3);cursor:not-allowed;transform:none}

    /* Product cards - clickable */
    .product-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-lg);overflow:hidden;transition:all .3s var(--ease);display:flex;flex-direction:column;cursor:pointer;position:relative}
    .product-card:hover{border-color:rgba(0,212,255,.2);transform:translateY(-4px);box-shadow:0 12px 40px rgba(0,0,0,.5)}
    .product-img{width:100%;height:210px;background:var(--bg-3);display:flex;align-items:center;justify-content:center;font-size:3.5rem;overflow:hidden;border-bottom:1px solid var(--border)}
    .product-img img{width:100%;height:100%;object-fit:cover}
    .product-body{padding:1.25rem;flex:1;display:flex;flex-direction:column}
    .product-cat{font-size:.75rem;font-weight:700;letter-spacing:.06em;text-transform:uppercase;color:var(--accent);margin-bottom:.375rem}
    .product-name{font-family:var(--font-d);font-size:1rem;font-weight:700;margin-bottom:.5rem;line-height:1.3}
    .product-desc{font-size:.8125rem;color:var(--text-2);line-height:1.5;flex:1;margin-bottom:1rem;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
    .product-footer{display:flex;align-items:center;justify-content:space-between;gap:.75rem;margin-top:auto}
    .product-price{font-family:'JetBrains Mono',monospace;font-size:1.25rem;font-weight:700;letter-spacing:-.01em}
    .add-btn{padding:.5rem 1rem;background:var(--accent);color:#080A0F;border:none;border-radius:var(--radius);cursor:pointer;font-family:var(--font-b);font-size:.8125rem;font-weight:700;transition:all .2s}
    .add-btn:hover{box-shadow:0 0 16px var(--accent-glow);transform:scale(1.03)}
    .add-btn:disabled{background:var(--surface-2);color:var(--text-3);cursor:not-allowed;transform:none}
    
    /* Product badges with more spacing (–ø.3) */
    .product-badges{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:.75rem}
    .product-badge{display:inline-flex;align-items:center;padding:.25rem .625rem;border-radius:6px;font-size:.75rem;font-weight:700}
    .badge-featured{background:var(--accent-dim);color:var(--accent);border:1px solid rgba(0,212,255,.2)}
    .badge-stock{background:var(--green-dim);color:var(--green);border:1px solid rgba(0,229,160,.2)}
    .badge-preorder{background:var(--amber-dim);color:var(--amber);border:1px solid rgba(255,176,32,.2)}
    .badge-out{background:var(--red-dim);color:var(--red);border:1px solid rgba(255,71,87,.2)}
    
    /* Product Detail Modal (–ø.4) */
    .product-detail-modal{position:fixed;inset:0;background:rgba(0,0,0,.75);backdrop-filter:blur(8px);z-index:600;display:none;align-items:center;justify-content:center;padding:1.5rem}
    .product-detail-modal.active{display:flex}
    .product-detail-box{background:var(--bg-2);border:1px solid var(--border-hover);border-radius:var(--radius-xl);width:100%;max-width:900px;max-height:90vh;overflow-y:auto;animation:fadeUp .3s var(--ease);display:flex;flex-direction:column}
    .product-detail-header{position:sticky;top:0;background:var(--bg-2);padding:1.25rem 1.5rem;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;z-index:10}
    .product-detail-content{padding:2rem;display:grid;grid-template-columns:1fr 1fr;gap:2rem}
    .product-gallery{display:flex;flex-direction:column;gap:1rem}
    .product-main-img{width:100%;aspect-ratio:1;background:var(--bg-3);border:1px solid var(--border);border-radius:var(--radius-lg);overflow:hidden;display:flex;align-items:center;justify-content:center;font-size:4rem}
    .product-main-img img{width:100%;height:100%;object-fit:cover}
    .product-thumbnails{display:flex;gap:.75rem;overflow-x:auto}
    .product-thumb{width:80px;height:80px;background:var(--bg-3);border:2px solid var(--border);border-radius:var(--radius);cursor:pointer;overflow:hidden;display:flex;align-items:center;justify-content:center;font-size:1.5rem;transition:border-color .2s}
    .product-thumb:hover,.product-thumb.active{border-color:var(--accent)}
    .product-thumb img{width:100%;height:100%;object-fit:cover}
    .product-info{display:flex;flex-direction:column;gap:1.5rem}
    .product-detail-title{font-family:var(--font-d);font-size:1.75rem;font-weight:800;line-height:1.2;margin-bottom:.5rem}
    .product-detail-cat{font-size:.875rem;color:var(--accent);font-weight:600;text-transform:uppercase;letter-spacing:.06em}
    .product-detail-price{font-family:'JetBrains Mono',monospace;font-size:2rem;font-weight:700;color:var(--accent)}
    .product-detail-desc{font-size:.9375rem;line-height:1.7;color:var(--text-2)}
    .product-characteristics{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-lg);padding:1.25rem}
    .char-title{font-family:var(--font-d);font-size:1rem;font-weight:700;margin-bottom:1rem}
    .char-list{display:flex;flex-direction:column;gap:.75rem}
    .char-item{display:flex;justify-content:space-between;align-items:center;padding:.5rem 0;border-bottom:1px solid var(--border)}
    .char-item:last-child{border-bottom:none}
    .char-name{font-size:.875rem;color:var(--text-3);font-weight:600}
    .char-value{font-size:.875rem;color:var(--text);font-weight:500}
    .product-actions{display:flex;gap:1rem;align-items:center;padding-top:1rem;border-top:1px solid var(--border)}
    .qty-selector{display:flex;align-items:center;gap:.75rem}
    .qty-label{font-size:.875rem;color:var(--text-2)}
    .qty-controls{display:flex;align-items:center;gap:.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:.25rem}
    .qty-btn{width:32px;height:32px;background:none;border:none;color:var(--text);cursor:pointer;font-size:1.125rem;border-radius:6px;transition:background .2s;display:flex;align-items:center;justify-content:center}
    .qty-btn:hover{background:rgba(255,255,255,.08)}
    .qty-btn:disabled{opacity:.4;cursor:not-allowed}
    .qty-input{width:48px;text-align:center;background:none;border:none;color:var(--text);font-family:'JetBrains Mono',monospace;font-size:.9375rem;font-weight:600}
    .add-to-cart-btn{flex:1;padding:.875rem 1.5rem;background:var(--accent);color:#080A0F;border:none;border-radius:var(--radius);cursor:pointer;font-family:var(--font-b);font-size:.9375rem;font-weight:700;transition:all .2s;display:flex;align-items:center;justify-content:center;gap:.5rem}
    .add-to-cart-btn:hover{box-shadow:0 0 24px var(--accent-glow);transform:translateY(-2px)}
    .add-to-cart-btn:disabled{background:var(--surface-2);color:var(--text-3);cursor:not-allowed;transform:none}
    
    /* Specifications selector in detail modal */
    .specs-selector{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-lg);padding:1.25rem}
    .specs-title{font-size:.875rem;font-weight:700;color:var(--text-2);text-transform:uppercase;letter-spacing:.06em;margin-bottom:.75rem}
    .specs-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:.75rem}
    .spec-option{padding:.75rem 1rem;background:var(--bg-3);border:2px solid var(--border);border-radius:var(--radius);cursor:pointer;transition:all .2s;text-align:center}
    .spec-option:hover{border-color:var(--border-hover)}
    .spec-option.active{border-color:var(--accent);background:var(--accent-dim)}
    .spec-name{font-size:.8125rem;font-weight:600;margin-bottom:.25rem}
    .spec-price{font-size:.75rem;color:var(--text-3)}
    
    @media (max-width:768px){
      .product-detail-content{grid-template-columns:1fr;gap:1.5rem}
      .product-detail-box{max-height:95vh}
    }

    /* Footer */
    .footer{background:var(--bg-2);border-top:1px solid var(--border);padding:3rem 0 0}
    .footer-grid{display:grid;grid-template-columns:1.5fr repeat(3,1fr);gap:3rem;padding-bottom:3rem}
    .footer-brand-desc{font-size:.875rem;color:var(--text-2);line-height:1.7;margin-top:1rem;max-width:280px}
    .footer-col-title{font-size:.75rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;color:var(--text-3);margin-bottom:1rem}
    .footer-links{list-style:none;display:flex;flex-direction:column;gap:.5rem}
    .footer-links a{font-size:.875rem;color:var(--text-2);text-decoration:none;transition:color .2s}
    .footer-links a:hover{color:var(--accent)}
    .footer-contact-item{display:flex;align-items:center;gap:.625rem;font-size:.875rem;color:var(--text-2);margin-bottom:.625rem}
    .footer-contact-item a{color:var(--text-2);text-decoration:none;transition:color .2s}
    .footer-contact-item a:hover{color:var(--accent)}
    .footer-bottom{border-top:1px solid var(--border);padding:1.25rem 0;display:flex;align-items:center;justify-content:space-between;gap:1rem;flex-wrap:wrap}
    .footer-bottom span,.footer-bottom a{font-size:.8125rem;color:var(--text-3);text-decoration:none;transition:color .2s}
    .footer-bottom a:hover{color:var(--accent)}
    .footer-legal-links{display:flex;gap:1.5rem;flex-wrap:wrap}

    /* Auth modal */
    .modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.65);backdrop-filter:blur(6px);z-index:500;display:none;align-items:center;justify-content:center;padding:1rem}
    .modal-overlay.active{display:flex}
    .modal-box{background:var(--bg-3);border:1px solid var(--border-hover);border-radius:var(--radius-xl);padding:2rem;width:100%;max-width:440px;box-shadow:var(--shadow-lg);animation:fadeUp .3s var(--ease)}
    .modal-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:1.5rem}
    .modal-title{font-family:var(--font-d);font-size:1.25rem;font-weight:700}
    .modal-close{background:none;border:none;color:var(--text-3);font-size:1.25rem;cursor:pointer;line-height:1;padding:.25rem;transition:color .2s}
    .modal-close:hover{color:var(--text)}
    .auth-tabs{display:flex;gap:.25rem;margin-bottom:1.5rem;background:var(--surface);padding:.25rem;border-radius:var(--radius)}
    .auth-tab{flex:1;padding:.5rem;background:none;border:none;color:var(--text-2);cursor:pointer;font-family:var(--font-b);font-size:.875rem;font-weight:600;border-radius:7px;transition:all .2s}
    .auth-tab.active{background:var(--accent);color:#080A0F}
    .form-group{margin-bottom:1rem}
    .form-label{display:block;font-size:.8125rem;font-weight:600;color:var(--text-2);margin-bottom:.375rem;letter-spacing:.03em;text-transform:uppercase}
    .form-input{width:100%;padding:.75rem 1rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);color:var(--text);font-family:var(--font-b);font-size:.9375rem;outline:none;transition:all .2s}
    .form-input::placeholder{color:var(--text-3)}
    .form-input:focus{border-color:var(--accent);background:var(--bg);box-shadow:0 0 0 3px var(--accent-dim)}
    .auth-messages{margin-bottom:.75rem}
    .msg{padding:.75rem 1rem;border-radius:var(--radius);font-size:.875rem;font-weight:500;border:1px solid transparent;margin-bottom:.5rem}
    .msg-error{background:var(--red-dim);color:var(--red);border-color:rgba(255,71,87,.2)}
    .msg-success{background:var(--green-dim);color:var(--green);border-color:rgba(0,229,160,.2)}

    /* Privacy checkbox */
    .privacy-check-row{display:flex;align-items:flex-start;gap:.75rem;margin:.75rem 0 1rem;padding:.875rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);cursor:pointer}
    .privacy-check-row input[type=checkbox]{width:18px;height:18px;margin-top:2px;accent-color:var(--accent);flex-shrink:0;cursor:pointer}
    .privacy-check-text{font-size:.8125rem;color:var(--text-2);line-height:1.5}
    .privacy-check-text a{color:var(--accent);text-decoration:none}
    .privacy-check-text a:hover{text-decoration:underline}

    /* Cart */
    .cart-overlay{position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:300;opacity:0;pointer-events:none;transition:opacity .3s}
    .cart-overlay.active{opacity:1;pointer-events:all}
    .cart-drawer{position:fixed;right:0;top:0;bottom:0;width:400px;max-width:100vw;background:var(--bg-3);border-left:1px solid var(--border);z-index:400;display:flex;flex-direction:column;transform:translateX(100%);transition:transform .3s var(--ease)}
    .cart-drawer.active{transform:translateX(0)}
    .cart-dh{display:flex;align-items:center;justify-content:space-between;padding:1.25rem 1.5rem;border-bottom:1px solid var(--border)}
    .cart-dh-title{font-family:var(--font-d);font-size:1.125rem;font-weight:700}
    .cart-db{flex:1;overflow-y:auto;padding:1rem 1.5rem}
    .cart-df{padding:1.25rem 1.5rem;border-top:1px solid var(--border)}
    .cart-empty{display:flex;flex-direction:column;align-items:center;gap:.75rem;padding:3rem 0;color:var(--text-3)}
    .cart-empty-icon{font-size:3rem;opacity:.4}
    .cart-item{display:flex;gap:1rem;padding:.875rem 0;border-bottom:1px solid var(--border);align-items:center}
    .cart-item-img{width:56px;height:56px;background:var(--surface);border-radius:var(--radius);display:flex;align-items:center;justify-content:center;font-size:1.5rem;flex-shrink:0;overflow:hidden}
    .cart-item-img img{width:100%;height:100%;object-fit:cover}
    .cart-item-info{flex:1;min-width:0}
    .cart-item-name{font-size:.875rem;font-weight:600;margin-bottom:.25rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .cart-item-price{font-size:.8125rem;color:var(--text-2)}
    .cart-item-remove{background:none;border:none;color:var(--text-3);cursor:pointer;font-size:1rem;padding:.25rem;transition:color .2s}
    .cart-item-remove:hover{color:var(--red)}
    .cart-total-row{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}
    .cart-total-label{font-size:.875rem;color:var(--text-2)}
    .cart-total-amount{font-family:var(--font-d);font-size:1.25rem;font-weight:800}

    /* User menu */
    .user-btn{display:flex;align-items:center;gap:.5rem;background:var(--surface);border:1px solid var(--border);color:var(--text);padding:.375rem .875rem .375rem .5rem;border-radius:var(--radius);cursor:pointer;font-family:var(--font-b);font-size:.875rem;transition:all .2s}
    .user-btn:hover{border-color:var(--border-hover)}
    .user-avatar{width:28px;height:28px;background:linear-gradient(135deg,var(--accent),#0099CC);border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:.8125rem;font-weight:700;color:#080A0F}
    .user-dropdown-wrap{position:relative}
    .user-dropdown{position:absolute;right:0;top:calc(100% + .5rem);background:var(--bg-3);border:1px solid var(--border-hover);border-radius:var(--radius-lg);padding:.5rem;min-width:200px;box-shadow:var(--shadow-lg);opacity:0;pointer-events:none;transform:translateY(-6px);transition:all .2s var(--ease);z-index:50}
    .user-dropdown.active{opacity:1;pointer-events:all;transform:translateY(0)}
    .user-info-box{padding:.5rem .75rem .75rem;border-bottom:1px solid var(--border);margin-bottom:.375rem}
    .user-info-name{font-weight:700;font-size:.9375rem}
    .user-info-email{font-size:.8125rem;color:var(--text-2)}
    .drop-item{display:flex;align-items:center;gap:.5rem;width:100%;padding:.5rem .75rem;background:none;border:none;border-radius:7px;color:var(--text-2);cursor:pointer;font-family:var(--font-b);font-size:.875rem;text-decoration:none;transition:all .2s}
    .drop-item:hover{background:rgba(255,255,255,.06);color:var(--text)}
    .drop-item.danger{color:var(--red)}
    .drop-item.danger:hover{background:var(--red-dim)}

    /* Toast */
    .toast{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%) translateY(1rem);background:var(--surface-2);color:var(--text);padding:.75rem 1.5rem;border-radius:100px;font-size:.875rem;font-weight:500;opacity:0;pointer-events:none;transition:all .3s var(--ease);z-index:9000;white-space:nowrap;border:1px solid var(--border-hover)}
    .toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
    .toast-success{background:var(--green-dim);color:var(--green);border-color:rgba(0,229,160,.25)}
    .toast-error{background:var(--red-dim);color:var(--red);border-color:rgba(255,71,87,.25)}

    /* Cookie banner */
    .cookie-banner{position:fixed;bottom:0;left:0;right:0;background:var(--bg-3);border-top:1px solid var(--border-hover);padding:1rem 0;z-index:8000;transform:translateY(100%);transition:transform .4s var(--ease)}
    .cookie-banner.show{transform:translateY(0)}
    .cookie-inner{display:flex;align-items:center;justify-content:space-between;gap:1.5rem;flex-wrap:wrap}
    .cookie-icon{font-size:1.5rem;flex-shrink:0}
    .cookie-text{flex:1;min-width:240px}
    .cookie-text strong{font-size:.9375rem;font-weight:700;display:block;margin-bottom:.25rem}
    .cookie-text p{font-size:.8125rem;color:var(--text-2);line-height:1.5}
    .cookie-text a{color:var(--accent);text-decoration:none}
    .cookie-text a:hover{text-decoration:underline}
    .cookie-actions{display:flex;gap:.625rem;flex-shrink:0;flex-wrap:wrap}
    .btn-cookie-accept{background:var(--accent);color:#080A0F;border:none;padding:.5rem 1.25rem;border-radius:var(--radius);cursor:pointer;font-family:var(--font-b);font-size:.875rem;font-weight:700;transition:all .2s}
    .btn-cookie-accept:hover{opacity:.9}
    .btn-cookie-decline{background:transparent;color:var(--text-2);border:1px solid var(--border);padding:.5rem 1.25rem;border-radius:var(--radius);cursor:pointer;font-family:var(--font-b);font-size:.875rem;font-weight:600;transition:all .2s}
    .btn-cookie-decline:hover{border-color:var(--border-hover);color:var(--text)}

    @media(max-width:768px){
      .nav{display:none}
      .footer-grid{grid-template-columns:1fr 1fr;gap:2rem}
      .hero-stats{gap:1.5rem}
      .cookie-inner{flex-direction:column;align-items:flex-start}
    }
    @media(max-width:480px){
      .footer-grid{grid-template-columns:1fr}
    }
      /* Quantity controls */
    .qty-btn{width:28px;height:28px;background:var(--surface-2);border:1px solid var(--border);border-radius:6px;color:var(--text);cursor:pointer;font-size:1rem;font-weight:700;display:flex;align-items:center;justify-content:center;transition:all .2s}
    .qty-btn:hover{background:var(--accent-dim);border-color:var(--accent);color:var(--accent)}
    .qty-input{width:50px;height:28px;background:var(--surface-2);border:1px solid var(--border);border-radius:6px;color:var(--text);text-align:center;font-size:.875rem;font-weight:600;outline:none}
    .qty-input:focus{border-color:var(--accent);box-shadow:0 0 0 2px var(--accent-dim)}    /* IMPORT Logo - Lightning bolt effect */
    .logo-mark,.admin-logo-mark,.login-mark{
      position:relative;
      overflow:hidden;
    }
    .logo-mark::after,.admin-logo-mark::after,.login-mark::after{
      content:'‚ö°';
      position:absolute;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      background:linear-gradient(135deg,#00D4FF 0%,#0099CC 100%);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      background-clip:text;
      font-size:inherit;
    }


  </style>
</head>
<body>

<!-- ‚îÄ‚îÄ COOKIE BANNER ‚îÄ‚îÄ -->
<div class="cookie-banner" id="cookieBanner">
  <div class="container">
    <div class="cookie-inner">
      <div class="cookie-icon">üç™</div>
      <div class="cookie-text">
        <strong>–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º Cookie</strong>
        <p>
          Cookie ‚Äî –Ω–µ–±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ —Å–µ—Å—Å–∏–∏), –∑–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫–æ—Ä–∑–∏–Ω—ã –∏ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏. –ë–µ–∑ cookie —Å–∞–π—Ç –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –ü–æ–¥—Ä–æ–±–Ω–µ–µ –≤ –Ω–∞—à–µ–π
          <a href="/privacy-policy" target="_blank">–ü–æ–ª–∏—Ç–∏–∫–µ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>.
        </p>
      </div>
      <div class="cookie-actions">
        <button class="btn-cookie-accept" id="cookieAccept">–ü—Ä–∏–Ω—è—Ç—å –≤—Å–µ</button>
        <button class="btn-cookie-decline" id="cookieDecline">–¢–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ</button>
      </div>
    </div>
  </div>
</div>

<!-- ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ -->
<header class="header">
  <div class="container">
    <div class="header-inner">
      <a href="/" class="logo">
        <div class="logo-mark">‚ö°</div>
        <span class="logo-text">IM<span>PORT</span></span>
      </a>
      <nav class="nav">
        <a href="/" class="nav-link active">–ì–ª–∞–≤–Ω–∞—è</a>
        <a href="/products" class="nav-link">–ö–∞—Ç–∞–ª–æ–≥</a>
      </nav>
      <div class="header-actions">
        <button class="btn btn-ghost btn-sm cart-btn" id="cartBtn">
          üõí –ö–æ—Ä–∑–∏–Ω–∞
          <span class="cart-count" id="cartCount">0</span>
        </button>
        <div class="user-dropdown-wrap" id="userMenu"></div>
      </div>
    </div>
  </div>
</header>

<!-- ‚îÄ‚îÄ HERO ‚îÄ‚îÄ -->
<section class="hero">
  <div class="hero-bg">
    <div class="hero-glow-1"></div>
    <div class="hero-glow-2"></div>
    <div class="hero-grid"></div>
  </div>
  <div class="container">
    <div class="hero-content">
      <div class="hero-eyebrow">‚ö° –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∑–∞–ø—á–∞—Å—Ç–∏ –¥–ª—è —ç–ª–µ–∫—Ç—Ä–æ—Å–∞–º–æ–∫–∞—Ç–æ–≤</div>
      <h1 class="hero-title">
        –ó–∞–ø—á–∞—Å—Ç–∏ –Ω–æ–≤–æ–≥–æ<br>–ø–æ–∫–æ–ª–µ–Ω–∏—è –¥–ª—è<br><span class="accent">–≤–∞—à–µ–≥–æ —Å–∞–º–æ–∫–∞—Ç–∞</span>
      </h1>
      <p class="hero-desc">–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä—ã, –º–æ—Ç–æ—Ä—ã, —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞ –∏ –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã ‚Äî –≤—Å—ë –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤–∞—à–µ–≥–æ —Å–∞–º–æ–∫–∞—Ç–∞.</p>
      <div class="hero-actions">
        <a href="/products" class="btn btn-primary btn-lg">–°–º–æ—Ç—Ä–µ—Ç—å –∫–∞—Ç–∞–ª–æ–≥ ‚Üí</a>
        <button class="btn btn-ghost btn-lg" onclick="document.getElementById('authBtn')?.click() || showAuthModal()">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
      </div>
      <div class="hero-stats">
        <div>
          <span class="hero-stat-val" id="statProducts">‚Äî</span>
          <div class="hero-stat-label">–¢–æ–≤–∞—Ä–æ–≤ –≤ –Ω–∞–ª–∏—á–∏–∏</div>
        </div>
        <div>
          <span class="hero-stat-val" id="statCategories">‚Äî</span>
          <div class="hero-stat-label">–ö–∞—Ç–µ–≥–æ—Ä–∏–π</div>
        </div>
        <div>
          <span class="hero-stat-val" id="statOrders">‚Äî</span>
          <div class="hero-stat-label">–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤</div>
        </div>
        <div>
          <span class="hero-stat-val">24/7</span>
          <div class="hero-stat-label">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ‚îÄ‚îÄ PRODUCTS ‚îÄ‚îÄ -->
<section class="section" style="background:var(--bg-2);border-top:1px solid var(--border)">
  <div class="container">
    <div class="section-header">
      <div>
        <div class="section-tag">–ù–æ–≤–∏–Ω–∫–∏</div>
        <h2 class="section-title">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</h2>
      </div>
      <a href="/products" class="btn btn-ghost btn-sm">–í—Å–µ —Ç–æ–≤–∞—Ä—ã ‚Üí</a>
    </div>
    <div class="products-grid" id="productsGrid">
      <div style="grid-column:1/-1;text-align:center;padding:3rem;color:var(--text-3)">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</div>
    </div>
  </div>
</section>

<!-- ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ -->
<footer class="footer">
  <div class="container">
    <div class="footer-grid">
      <div>
        <a href="/" class="logo" style="font-size:1.125rem">
          <div class="logo-mark" style="width:28px;height:28px;font-size:14px">‚ö°</div>
          <span class="logo-text">IM<span>PORT</span></span>
        </a>
        <p class="footer-brand-desc">–ü—Ä–µ–º–∏—É–º –∑–∞–ø—á–∞—Å—Ç–∏ –¥–ª—è —ç–ª–µ–∫—Ç—Ä–æ—Å–∞–º–æ–∫–∞—Ç–æ–≤. –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ —Å –≥–∞—Ä–∞–Ω—Ç–∏–µ–π –∫–∞—á–µ—Å—Ç–≤–∞.</p>
      </div>
      <div>
        <div class="footer-col-title">–ö–∞—Ç–∞–ª–æ–≥</div>
        <ul class="footer-links">
          <li><a href="/products">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</a></li>
          <li><a href="/products?category=batteries">–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä—ã</a></li>
          <li><a href="/products?category=motors">–ú–æ—Ç–æ—Ä—ã</a></li>
          <li><a href="/products?category=electronics">–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</a></li>
          <li><a href="/products?category=brakes">–¢–æ—Ä–º–æ–∑–∞</a></li>
        </ul>
      </div>
      <div>
        <div class="footer-col-title">–î–æ–∫—É–º–µ–Ω—Ç—ã</div>
        <ul class="footer-links">
          <li><a href="/terms">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ</a></li>
          <li><a href="/privacy-policy">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a></li>
          <li><a href="/offer">–î–æ–≥–æ–≤–æ—Ä –æ—Ñ–µ—Ä—Ç—ã / –£—Å–ª–æ–≤–∏—è –ø—Ä–æ–¥–∞–∂–∏</a></li>
          <li><a href="/returns">–ü–æ–ª–∏—Ç–∏–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏ –æ–±–º–µ–Ω–∞</a></li>
        </ul>
      </div>
      <div>
        <div class="footer-col-title">–ö–æ–Ω—Ç–∞–∫—Ç—ã</div>
        <div class="footer-contact-item">üìç <span>–ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, 123</span></div>
        <div class="footer-contact-item">üìû <a href="tel:+78001234567">8 (800) 123-45-67</a></div>
        <div class="footer-contact-item">‚úâÔ∏è <a href="mailto:info@import.ru">info@import.ru</a></div>
        <div class="footer-contact-item">üïê <span>–ï–∂–µ–¥–Ω–µ–≤–Ω–æ 9:00‚Äì21:00</span></div>
      </div>
    </div>
    <div class="footer-bottom">
      <span>¬© 2025 IMPORT. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</span>
      <div class="footer-legal-links">
        <a href="/terms">–°–æ–≥–ª–∞—à–µ–Ω–∏–µ</a>
        <a href="/privacy-policy">–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å</a>
        <a href="/offer">–û—Ñ–µ—Ä—Ç–∞</a>
        <a href="/returns">–í–æ–∑–≤—Ä–∞—Ç</a>
      </div>
    </div>
  </div>
</footer>

<!-- ‚îÄ‚îÄ AUTH MODAL ‚îÄ‚îÄ -->
<div class="modal-overlay" id="authModal">
  <div class="modal-box">
    <div class="modal-header">
      <span class="modal-title">–ê–∫–∫–∞—É–Ω—Ç</span>
      <button class="modal-close" id="closeAuthModal">‚úï</button>
    </div>
    <div class="modal-body">
      <div class="auth-tabs">
        <button class="auth-tab active" data-tab="login">–í–æ–π—Ç–∏</button>
        <button class="auth-tab" data-tab="register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
      </div>
      <div id="authMessages" class="auth-messages"></div>

      <!-- Login -->
      <form id="loginForm">
        <div class="form-group">
          <label class="form-label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
          <input type="text" name="username" class="form-input" placeholder="username" required>
        </div>
        <div class="form-group">
          <label class="form-label">–ü–∞—Ä–æ–ª—å</label>
          <input type="password" name="password" class="form-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
        </div>
        <button type="submit" class="btn btn-primary" style="width:100%;margin-top:.5rem">–í–æ–π—Ç–∏ ‚Üí</button>
      </form>

      <!-- Register -->
      <form id="registerForm" style="display:none">
        <div class="form-group">
          <label class="form-label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
          <input type="text" name="username" class="form-input" placeholder="username" required>
        </div>
        <div class="form-group">
          <label class="form-label">Email</label>
          <input type="email" name="email" class="form-input" placeholder="you@example.com" required>
        </div>
        <div class="form-group">
          <label class="form-label">–ü–æ–ª–Ω–æ–µ –∏–º—è</label>
          <input type="text" name="full_name" class="form-input" placeholder="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤" required>
        </div>
        <div class="form-group">
          <label class="form-label">–ü–∞—Ä–æ–ª—å</label>
          <input type="password" name="password" class="form-input" placeholder="–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤" required>
        </div>

        <!-- Privacy checkbox -->
        <label class="privacy-check-row">
          <input type="checkbox" id="privacyCheckbox" required>
          <span class="privacy-check-text">
            –Ø –ø—Ä–æ—á–∏—Ç–∞–ª(–∞) –∏ –ø—Ä–∏–Ω–∏–º–∞—é
            <a href="/privacy-policy" target="_blank">–ü–æ–ª–∏—Ç–∏–∫—É –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>,
            <a href="/terms" target="_blank">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ</a>
            –∏ —Å–æ–≥–ª–∞—Å–µ–Ω(–Ω–∞) –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
          </span>
        </label>

        <button type="submit" class="btn btn-primary" style="width:100%;margin-top:.5rem" id="registerSubmitBtn">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç ‚Üí</button>
        <p style="text-align:center;margin-top:.75rem;font-size:.8125rem;color:var(--text-3)">
          –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="#" style="color:var(--accent);text-decoration:none" id="switchToLogin">–í–æ–π—Ç–∏</a>
        </p>
      </form>
    </div>
  </div>
</div>

<!-- ‚îÄ‚îÄ CART DRAWER ‚îÄ‚îÄ -->
<div class="cart-overlay" id="cartOverlay"></div>
<div class="cart-drawer" id="cartDrawer">
  <div class="cart-dh">
    <div class="cart-dh-title">üõí –ö–æ—Ä–∑–∏–Ω–∞</div>
    <button class="modal-close" id="closeCartDrawer">‚úï</button>
  </div>
  <div class="cart-db" id="cartBody">
    <div class="cart-empty"><div class="cart-empty-icon">üõí</div><p>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p></div>
  </div>
  <div class="cart-df">
    <div class="cart-total-row">
      <span class="cart-total-label">–ò—Ç–æ–≥–æ</span>
      <span class="cart-total-amount" id="cartTotal">0 ‚ÇΩ</span>
    </div>
    <button class="btn btn-primary" style="width:100%" id="checkoutBtn" disabled>–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑ ‚Üí</button>
  </div>
</div>

<div class="toast" id="toast"></div>

<!-- ‚îÄ‚îÄ PRODUCT DETAIL MODAL (–ø.4) ‚îÄ‚îÄ -->
<div class="product-detail-modal" id="productDetailModal">
  <div class="product-detail-box">
    <div class="product-detail-header">
      <h2 class="modal-title">–î–µ—Ç–∞–ª–∏ —Ç–æ–≤–∞—Ä–∞</h2>
      <button class="modal-close" id="closeProductDetail">‚úï</button>
    </div>
    <div class="product-detail-content" id="productDetailContent">
      <!-- Content will be loaded dynamically -->
    </div>
  </div>
</div>

<script>
  // ‚îÄ‚îÄ State ‚îÄ‚îÄ
  let currentUser = null;
  let cart = [];

  // ‚îÄ‚îÄ DOM ‚îÄ‚îÄ
  const authModal      = document.getElementById('authModal');
  const closeAuthModal = document.getElementById('closeAuthModal');
  const cartDrawer     = document.getElementById('cartDrawer');
  const cartOverlay    = document.getElementById('cartOverlay');
  const cartBtn        = document.getElementById('cartBtn');
  const cartCount      = document.getElementById('cartCount');
  const cartBody       = document.getElementById('cartBody');
  const cartTotal      = document.getElementById('cartTotal');
  const checkoutBtn    = document.getElementById('checkoutBtn');
  const userMenu       = document.getElementById('userMenu');
  const authMessages   = document.getElementById('authMessages');
  const loginForm      = document.getElementById('loginForm');
  const registerForm   = document.getElementById('registerForm');
  const authTabs       = document.querySelectorAll('.auth-tab');
  const toast          = document.getElementById('toast');
  const cookieBanner   = document.getElementById('cookieBanner');

  // ‚îÄ‚îÄ Toast ‚îÄ‚îÄ
  function showToast(type, text) {
    toast.textContent = text;
    toast.className = `toast toast-${type} show`;
    setTimeout(() => toast.classList.remove('show'), 3200);
  }

  function fmt(n) { return new Intl.NumberFormat('ru-RU').format(n); }

  function catName(id) {
    const map = { batteries:'–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä', motors:'–ú–æ—Ç–æ—Ä', electronics:'–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞',
                  brakes:'–¢–æ—Ä–º–æ–∑–∞', tires:'–ö–æ–ª—ë—Å–∞', accessories:'–ê–∫—Å–µ—Å—Å—É–∞—Ä' };
    return map[id] || id;
  }

  function catIcon(id) {
    const map = { batteries:'üîã', motors:'‚öôÔ∏è', electronics:'üì±',
                  brakes:'üõë', tires:'üõû', accessories:'üîß' };
    return map[id] || 'üì¶';
  }

  // ‚îÄ‚îÄ Cookie Banner ‚îÄ‚îÄ
  function initCookieBanner() {
    const consent = localStorage.getItem('cookie_consent');
    if (!consent) {
      setTimeout(() => cookieBanner.classList.add('show'), 800);
    }
  }

  document.getElementById('cookieAccept').addEventListener('click', () => {
    localStorage.setItem('cookie_consent', 'all');
    localStorage.setItem('cookie_consent_date', new Date().toISOString());
    cookieBanner.classList.remove('show');
    showToast('success', 'üç™ Cookie –ø—Ä–∏–Ω—è—Ç—ã. –°–ø–∞—Å–∏–±–æ!');
  });

  document.getElementById('cookieDecline').addEventListener('click', () => {
    localStorage.setItem('cookie_consent', 'necessary');
    localStorage.setItem('cookie_consent_date', new Date().toISOString());
    cookieBanner.classList.remove('show');
  });

  // ‚îÄ‚îÄ Auth ‚îÄ‚îÄ
  async function checkAuth(token) {
    try {
      const r = await fetch('/api/me', { headers: { Authorization: `Bearer ${token}` } });
      if (r.ok) { currentUser = await r.json(); updateAuthUI(); loadCart(); }
      else       { localStorage.removeItem('token'); }
    } catch {}
  }

  function updateAuthUI() {
    userMenu.innerHTML = '';
    if (currentUser) {
      const initial = (currentUser.username || '?')[0].toUpperCase();
      userMenu.innerHTML = `
        <div class="user-dropdown-wrap" id="udw">
          <button class="user-btn" id="userMenuBtn">
            <div class="user-avatar">${initial}</div>
            <span>${currentUser.username}</span><span>‚ñæ</span>
          </button>
          <div class="user-dropdown" id="userDropdown">
            <div class="user-info-box">
              <div class="user-info-name">${currentUser.username}</div>
              <div class="user-info-email">${currentUser.email}</div>
            </div>
            ${currentUser.is_admin ? '<a href="/admin" class="drop-item">‚öôÔ∏è –ü–∞–Ω–µ–ª—å admin</a>' : ''}
            <button class="drop-item danger" onclick="logout()">‚Üê –í—ã–π—Ç–∏</button>
          </div>
        </div>`;
      document.getElementById('userMenuBtn').addEventListener('click', e => {
        e.stopPropagation();
        document.getElementById('userDropdown').classList.toggle('active');
      });
    } else {
      userMenu.innerHTML = `<button class="btn btn-primary btn-sm" id="authBtn">–í–æ–π—Ç–∏</button>`;
      document.getElementById('authBtn').addEventListener('click', showAuthModal);
    }
  }

  document.addEventListener('click', () => {
    document.getElementById('userDropdown')?.classList.remove('active');
  });

  function logout() {
    localStorage.removeItem('token');
    currentUser = null; cart = [];
    updateAuthUI(); updateCartUI();
    showToast('success', '–í—ã –≤—ã—à–ª–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞');
  }

  // ‚îÄ‚îÄ Auth Modal ‚îÄ‚îÄ
  function showAuthModal() { authModal.classList.add('active'); }
  closeAuthModal.addEventListener('click', () => authModal.classList.remove('active'));
  authModal.addEventListener('click', e => { if (e.target === authModal) authModal.classList.remove('active'); });

  authTabs.forEach(tab => tab.addEventListener('click', () => {
    authTabs.forEach(t => t.classList.remove('active'));
    tab.classList.add('active');
    const which = tab.dataset.tab;
    loginForm.style.display = which === 'login' ? '' : 'none';
    registerForm.style.display = which === 'register' ? '' : 'none';
    authMessages.innerHTML = '';
  }));

  document.getElementById('switchToLogin')?.addEventListener('click', e => {
    e.preventDefault();
    authTabs[0].click();
  });

  function showAuthMsg(type, text) {
    authMessages.innerHTML = `<div class="msg msg-${type}">${text}</div>`;
  }

  loginForm.addEventListener('submit', async e => {
    e.preventDefault();
    const fd = new FormData(e.target);
    try {
      const r = await fetch('/api/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ username: fd.get('username'), password: fd.get('password') })
      });
      const data = await r.json();
      if (r.ok) {
        localStorage.setItem('token', data.access_token);
        currentUser = data.user;
        authModal.classList.remove('active');
        updateAuthUI(); loadCart();
        showToast('success', `–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${data.user.username}!`);
      } else {
        showAuthMsg('error', data.detail || '–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞');
      }
    } catch { showAuthMsg('error', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è'); }
  });

  registerForm.addEventListener('submit', async e => {
    e.preventDefault();
    const checkbox = document.getElementById('privacyCheckbox');
    if (!checkbox.checked) {
      showAuthMsg('error', '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∏–Ω—è—Ç—å –ü–æ–ª–∏—Ç–∏–∫—É –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏');
      return;
    }
    const fd = new FormData(e.target);
    try {
      const r = await fetch('/api/register', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          username: fd.get('username'),
          email: fd.get('email'),
          full_name: fd.get('full_name'),
          password: fd.get('password'),
          privacy_accepted: true
        })
      });
      const data = await r.json();
      if (r.ok) {
        showAuthMsg('success', '–ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω! –¢–µ–ø–µ—Ä—å –≤–æ–π–¥–∏—Ç–µ.');
        registerForm.reset();
        setTimeout(() => authTabs[0].click(), 1500);
      } else {
        showAuthMsg('error', data.detail || '–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏');
      }
    } catch { showAuthMsg('error', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è'); }
  });

  // ‚îÄ‚îÄ Cart ‚îÄ‚îÄ
  cartBtn.addEventListener('click', () => {
    cartDrawer.classList.add('active');
    cartOverlay.classList.add('active');
    if (currentUser) loadCart();
  });
  cartOverlay.addEventListener('click', closeCartDrawer);
  document.getElementById('closeCartDrawer').addEventListener('click', closeCartDrawer);
  function closeCartDrawer() {
    cartDrawer.classList.remove('active');
    cartOverlay.classList.remove('active');
  }

  async function loadCart() {
    const token = localStorage.getItem('token');
    if (!token) return;
    try {
      const r = await fetch('/api/cart', { headers: { Authorization: `Bearer ${token}` } });
      if (r.ok) { const data = await r.json(); cart = data.items || []; updateCartUI(); }
    } catch {}
  }

  function updateCartUI() {
    const count = cart.reduce((s, i) => s + i.quantity, 0);
    cartCount.textContent = count;
    cartCount.style.display = count > 0 ? 'flex' : 'none';

    if (!cart.length) {
      cartBody.innerHTML = '<div class="cart-empty"><div class="cart-empty-icon">üõí</div><p>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p></div>';
      cartTotal.textContent = '0 ‚ÇΩ';
      checkoutBtn.disabled = true;
      return;
    }

    const total = cart.reduce((s, i) => s + i.item_total, 0);
    cartTotal.textContent = fmt(total) + ' ‚ÇΩ';
    checkoutBtn.disabled = false;

    cartBody.innerHTML = cart.map(item => {
      const p = item.product;
      // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ø.2: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –∫–æ—Ä–∑–∏–Ω–µ
      const hasValidImage = p.image_url && p.image_url.trim() && 
                           (p.image_url.startsWith('/static/uploads/') || 
                            p.image_url.startsWith('http://') || 
                            p.image_url.startsWith('https://'));
      const imgHtml = hasValidImage
        ? `<img src="${p.image_url}" alt="${p.name}" onerror="this.parentElement.innerHTML='${catIcon(p.category)}'">`
        : catIcon(p.category);
      
      return `
      <div class="cart-item">
        <div class="cart-item-img">${imgHtml}</div>
        <div class="cart-item-info">
          <div class="cart-item-name">${p.name}</div>
          <div class="cart-item-price">${fmt(p.price)} ‚ÇΩ</div>
          <div class="qty-controls" style="display:flex;align-items:center;gap:.5rem;margin-top:.5rem">
            <button class="qty-btn" onclick="updateCartQty(${p.id}, ${item.quantity - 1}, ${p.stock})">‚àí</button>
            <input type="number" class="qty-input" value="${item.quantity}" min="1" max="${p.stock}" 
                   onchange="updateCartQty(${p.id}, this.value, ${p.stock})" readonly>
            <button class="qty-btn" onclick="updateCartQty(${p.id}, ${item.quantity + 1}, ${p.stock})">+</button>
            <span style="font-size:.75rem;color:var(--text-3);margin-left:.25rem">–ò—Ç–æ–≥–æ: ${fmt(item.item_total)} ‚ÇΩ</span>
          </div>
        </div>
        <button class="cart-item-remove" onclick="removeFromCart(${p.id})" title="–£–¥–∞–ª–∏—Ç—å">‚úï</button>
      </div>`;
    }).join('');
  }

  // –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–∞
  async function updateCartQty(productId, newQty, stock) {
    newQty = parseInt(newQty);
    if (newQty < 1) return removeFromCart(productId);
    if (newQty > stock) {
      showToast('error', '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ —Å–∫–ª–∞–¥–µ');
      return loadCart();
    }
    
    const token = localStorage.getItem('token');
    if (!token) return;
    
    try {
      const r = await fetch('/api/cart', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', Authorization: `Bearer ${token}` },
        body: JSON.stringify({ product_id: productId, quantity: newQty })
      });
      if (r.ok) {
        await loadCart();
      } else {
        const d = await r.json();
        showToast('error', d.detail || '–û—à–∏–±–∫–∞');
        await loadCart();
      }
    } catch {
      showToast('error', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è');
    }
  }

  async function addToCart(productId, stock) {
    const token = localStorage.getItem('token');
    if (!token) { 
      showAuthModal();
      showToast('info', '–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä –≤ –∫–æ—Ä–∑–∏–Ω—É');
      return; 
    }
    if (stock <= 0) { showToast('error', '–¢–æ–≤–∞—Ä –Ω–µ –≤ –Ω–∞–ª–∏—á–∏–∏'); return; }
    try {
      const r = await fetch('/api/cart', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', Authorization: `Bearer ${token}` },
        body: JSON.stringify({ product_id: productId, quantity: 1 })
      });
      if (r.ok) { await loadCart(); showToast('success', '‚úì –¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É'); }
      else { const d = await r.json(); showToast('error', d.detail || '–û—à–∏–±–∫–∞'); }
    } catch { showToast('error', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è'); }
  }

  async function removeFromCart(productId) {
    const token = localStorage.getItem('token');
    if (!token) return;
    try {
      const r = await fetch(`/api/cart/${productId}`, {
        method: 'DELETE', headers: { Authorization: `Bearer ${token}` }
      });
      if (r.ok) { await loadCart(); showToast('success', '–¢–æ–≤–∞—Ä —É–¥–∞–ª—ë–Ω –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã'); }
    } catch {}
  }

  checkoutBtn.addEventListener('click', async () => {
    const token = localStorage.getItem('token');
    if (!token) { showAuthModal(); return; }
    try {
      const r = await fetch('/api/orders', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', Authorization: `Bearer ${token}` },
        body: JSON.stringify({ delivery_address: '', comment: '' })
      });
      const data = await r.json();
      if (r.ok) {
        cart = []; updateCartUI(); closeCartDrawer();
        showToast('success', `‚úì –ó–∞–∫–∞–∑ #${data.order_id} –æ—Ñ–æ—Ä–º–ª–µ–Ω!`);
      } else { showToast('error', data.detail || '–û—à–∏–±–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è'); }
    } catch { showToast('error', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è'); }
  });

  // ‚îÄ‚îÄ Products ‚îÄ‚îÄ
  async function loadProducts() {
    try {
      const r = await fetch('/api/products?limit=8');
      if (!r.ok) return;
      const data = await r.json();
      renderProducts(data);
    } catch {}
  }

  function renderProducts(products) {
    const grid = document.getElementById('productsGrid');
    if (!products.length) {
      grid.innerHTML = '<div style="grid-column:1/-1;text-align:center;color:var(--text-3);padding:3rem">–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
      return;
    }
    grid.innerHTML = products.map(p => {
      const icon = catIcon(p.category);
      // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ø.2: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
      const hasValidImage = p.image_url && p.image_url.trim() && 
                           (p.image_url.startsWith('/static/uploads/') || 
                            p.image_url.startsWith('http://') || 
                            p.image_url.startsWith('https://'));
      const imgHtml = hasValidImage
        ? `<img src="${p.image_url}" alt="${p.name}" loading="lazy" onerror="this.parentElement.innerHTML='${icon}'">`
        : icon;
      
      // –ë–µ–π–¥–∂–∏ —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º spacing (–ø.3)
      let badges = [];
      if (p.featured) badges.push('<span class="product-badge badge-featured">‚≠ê –ü–æ–ø—É–ª—è—Ä–Ω—ã–π</span>');
      if (p.in_stock) badges.push('<span class="product-badge badge-stock">‚úì –í –Ω–∞–ª–∏—á–∏–∏</span>');
      if (p.preorder) badges.push('<span class="product-badge badge-preorder">üì¶ –ü—Ä–µ–¥–∑–∞–∫–∞–∑</span>');
      if (p.stock === 0) badges.push('<span class="product-badge badge-out">‚úï –ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏</span>');
      const badgesHtml = badges.length ? `<div class="product-badges">${badges.join('')}</div>` : '';
      
      return `
      <div class="product-card" onclick="openProductDetail(${p.id})">
        <div class="product-img">${imgHtml}</div>
        <div class="product-body">
          ${badgesHtml}
          <div class="product-cat">${catName(p.category)}</div>
          <div class="product-name">${p.name}</div>
          <div class="product-desc">${p.description}</div>
          <div class="product-footer">
            <span class="product-price">${fmt(p.price)} ‚ÇΩ</span>
            <button class="add-btn" onclick="event.stopPropagation(); addToCart(${p.id},${p.stock})" ${p.stock<=0?'disabled':''}>
              ${p.stock>0 ? '–í –∫–æ—Ä–∑–∏–Ω—É' : '–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏'}
            </button>
          </div>
        </div>
      </div>`;
    }).join('');
  }

  // ‚îÄ‚îÄ Stats ‚îÄ‚îÄ
  async function loadStats() {
    try {
      const r = await fetch('/api/stats');
      if (!r.ok) return;
      const d = await r.json();
      document.getElementById('statProducts').textContent = fmt(d.total_stock || 0);
      document.getElementById('statCategories').textContent = d.categories || 0;
      document.getElementById('statOrders').textContent = fmt(d.total_orders || 0);
    } catch {}
  }

  // ‚îÄ‚îÄ Init ‚îÄ‚îÄ
  (async () => {
    initCookieBanner();
    updateAuthUI();
    await loadStats();
    await loadProducts();
    const token = localStorage.getItem('token');
    if (token) await checkAuth(token);
  })();

  async function updateQuantity(productId, newQty, maxStock) {
    const qty = Math.max(1, Math.min(parseInt(newQty), maxStock));
    const token = localStorage.getItem('token');
    if (!token) return;
    try {
      const r = await fetch(`/api/cart/${productId}`, {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json', Authorization: `Bearer ${token}` },
        body: JSON.stringify({ quantity: qty })
      });
      if (r.ok) { await loadCart(); }
      else { const d = await r.json(); showToast('error', d.detail || '–û—à–∏–±–∫–∞'); }
    } catch { showToast('error', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è'); }
  }

  // Close modals on overlay click
  document.querySelectorAll('.modal-overlay').forEach(overlay => {
    overlay.addEventListener('click', e => { if (e.target === overlay) overlay.classList.remove('active'); });
  });
  
  // ‚îÄ‚îÄ PRODUCT DETAIL MODAL (–ø.4) ‚îÄ‚îÄ
  const productDetailModal = document.getElementById('productDetailModal');
  const closeProductDetail = document.getElementById('closeProductDetail');
  const productDetailContent = document.getElementById('productDetailContent');
  let currentDetailProduct = null;
  let selectedSpec = null;
  let detailQty = 1;
  
  async function openProductDetail(productId) {
    try {
      const r = await fetch(`/api/products/${productId}`);
      if (!r.ok) return showToast('error', '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ–≤–∞—Ä');
      const product = await r.json();
      currentDetailProduct = product;
      selectedSpec = null;
      detailQty = 1;
      renderProductDetail(product);
      productDetailModal.classList.add('active');
    } catch (e) {
      showToast('error', '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–∞');
    }
  }
  
  function renderProductDetail(p) {
    const icon = catIcon(p.category);
    const hasValidImage = p.image_url && p.image_url.trim() && 
                         (p.image_url.startsWith('/static/uploads/') || 
                          p.image_url.startsWith('http://') || 
                          p.image_url.startsWith('https://'));
    
    // –û—Å–Ω–æ–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    const mainImgHtml = hasValidImage
      ? `<img src="${p.image_url}" alt="${p.name}">`
      : icon;
    
    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–µ—Å–ª–∏ –µ—Å—Ç—å)
    let thumbnailsHtml = '';
    if (p.images && p.images.length > 0) {
      const allImages = [p.image_url, ...p.images];
      thumbnailsHtml = `
        <div class="product-thumbnails">
          ${allImages.map((img, idx) => {
            const imgSrc = img && img.trim() ? img : '';
            return imgSrc ? `<div class="product-thumb ${idx === 0 ? 'active' : ''}" onclick="switchProductImage('${imgSrc}', this)">
              <img src="${imgSrc}" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ${idx + 1}">
            </div>` : '';
          }).join('')}
        </div>
      `;
    }
    
    // –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
    let charsHtml = '';
    if (p.characteristics && p.characteristics.length > 0) {
      charsHtml = `
        <div class="product-characteristics">
          <div class="char-title">üìã –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</div>
          <div class="char-list">
            ${p.characteristics.map(c => `
              <div class="char-item">
                <span class="char-name">${c.char_name}</span>
                <span class="char-value">${c.char_value}</span>
              </div>
            `).join('')}
          </div>
        </div>
      `;
    }
    
    // –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
    let specsHtml = '';
    if (p.has_specifications && p.specifications && p.specifications.length > 0) {
      specsHtml = `
        <div class="specs-selector">
          <div class="specs-title">üîß –í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ä—Å–∏—é / –ø–æ–∫–æ–ª–µ–Ω–∏–µ</div>
          <div class="specs-grid">
            ${p.specifications.map((spec, idx) => `
              <div class="spec-option ${selectedSpec?.id === spec.id ? 'active' : ''}" 
                   onclick="selectSpecification(${spec.id})">
                <div class="spec-name">${spec.name}</div>
                <div class="spec-price">${fmt(spec.price)} ‚ÇΩ</div>
              </div>
            `).join('')}
          </div>
        </div>
      `;
    }
    
    // –ü–æ–ª—É—á–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—É—é —Ü–µ–Ω—É –∏ –Ω–∞–ª–∏—á–∏–µ
    const currentItem = selectedSpec || p;
    const currentPrice = selectedSpec ? selectedSpec.price : p.price;
    const currentStock = selectedSpec ? selectedSpec.stock : p.stock;
    const inStock = currentStock > 0;
    
    productDetailContent.innerHTML = `
      <div class="product-gallery">
        <div class="product-main-img" id="productMainImg">${mainImgHtml}</div>
        ${thumbnailsHtml}
      </div>
      <div class="product-info">
        <div>
          <div class="product-detail-cat">${catName(p.category)}</div>
          <h2 class="product-detail-title">${p.name}${selectedSpec ? ` - ${selectedSpec.name}` : ''}</h2>
          <div class="product-detail-price">${fmt(currentPrice)} ‚ÇΩ</div>
        </div>
        
        ${specsHtml}
        
        <div class="product-detail-desc">
          <strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong><br>
          ${selectedSpec ? selectedSpec.description || p.description : p.description}
        </div>
        
        ${charsHtml}
        
        <div class="product-actions">
          <div class="qty-selector">
            <span class="qty-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</span>
            <div class="qty-controls">
              <button class="qty-btn" onclick="changeDetailQty(-1)" ${!inStock ? 'disabled' : ''}>‚àí</button>
              <input type="number" class="qty-input" value="${detailQty}" min="1" max="${currentStock}" readonly>
              <button class="qty-btn" onclick="changeDetailQty(1)" ${!inStock ? 'disabled' : ''}>+</button>
            </div>
          </div>
          <button class="add-to-cart-btn" onclick="addToCartFromDetail()" ${!inStock ? 'disabled' : ''}>
            ${inStock ? 'üõí –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É' : '‚úï –ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏'}
          </button>
        </div>
      </div>
    `;
  }
  
  function switchProductImage(imgSrc, thumbEl) {
    document.getElementById('productMainImg').innerHTML = `<img src="${imgSrc}" alt="Product image">`;
    document.querySelectorAll('.product-thumb').forEach(t => t.classList.remove('active'));
    thumbEl.classList.add('active');
  }
  
  function selectSpecification(specId) {
    if (!currentDetailProduct.specifications) return;
    selectedSpec = currentDetailProduct.specifications.find(s => s.id === specId);
    detailQty = 1;
    renderProductDetail(currentDetailProduct);
  }
  
  function changeDetailQty(delta) {
    const currentItem = selectedSpec || currentDetailProduct;
    const maxStock = currentItem.stock || 0;
    detailQty = Math.max(1, Math.min(detailQty + delta, maxStock));
    renderProductDetail(currentDetailProduct);
  }
  
  async function addToCartFromDetail() {
    const token = localStorage.getItem('token');
    if (!token) {
      productDetailModal.classList.remove('active');
      showAuthModal();
      showToast('info', '–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä –≤ –∫–æ—Ä–∑–∏–Ω—É');
      return;
    }
    
    // –ï—Å–ª–∏ –µ—Å—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏, –Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ –≤—ã–±—Ä–∞–Ω–æ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
    if (currentDetailProduct.has_specifications && currentDetailProduct.specifications.length > 0 && !selectedSpec) {
      showToast('error', '–í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ä—Å–∏—é / –ø–æ–∫–æ–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞');
      return;
    }
    
    // TODO: –ö–æ–≥–¥–∞ –±—É–¥–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π –≤ –∫–æ—Ä–∑–∏–Ω–µ, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å spec_id
    // –ü–æ–∫–∞ –¥–æ–±–∞–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–æ–≤–∞—Ä
    const productId = currentDetailProduct.id;
    const stock = selectedSpec ? selectedSpec.stock : currentDetailProduct.stock;
    
    if (stock <= 0) {
      showToast('error', '–¢–æ–≤–∞—Ä –Ω–µ –≤ –Ω–∞–ª–∏—á–∏–∏');
      return;
    }
    
    try {
      const r = await fetch('/api/cart', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', Authorization: `Bearer ${token}` },
        body: JSON.stringify({ product_id: productId, quantity: detailQty })
      });
      
      if (r.ok) {
        await loadCart();
        productDetailModal.classList.remove('active');
        showToast('success', `‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ ${detailQty} —à—Ç. –≤ –∫–æ—Ä–∑–∏–Ω—É`);
      } else {
        const d = await r.json();
        showToast('error', d.detail || '–û—à–∏–±–∫–∞');
      }
    } catch {
      showToast('error', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è');
    }
  }
  
  closeProductDetail.addEventListener('click', () => {
    productDetailModal.classList.remove('active');
  });
  
  productDetailModal.addEventListener('click', (e) => {
    if (e.target === productDetailModal) {
      productDetailModal.classList.remove('active');
    }
  });
</script>
</body>
</html>
