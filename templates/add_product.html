<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Favicons - IMPORT Branding -->
  <link rel="apple-touch-icon" sizes="180x180" href="/static/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/static/favicon/favicon-512x512.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/static/favicon/favicon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/static/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/static/favicon/favicon-16x16.png">
  <link rel="shortcut icon" href="/static/favicon/favicon.ico">
  <meta name="theme-color" content="#080A0F">
  <title>IMPORT ‚Äî –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</title>
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;700;800&family=DM+Sans:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#080A0F;--bg-3:#12161E;--surface:#161B24;--border:rgba(255,255,255,.06);--border-hover:rgba(255,255,255,.12);--text:#F0F2F5;--text-2:#8B92A5;--text-3:#4E5568;--accent:#00D4FF;--accent-dim:rgba(0,212,255,.12);--green:#00E5A0;--green-dim:rgba(0,229,160,.12);--red:#FF4757;--red-dim:rgba(255,71,87,.12);--radius:10px;--radius-xl:24px;--font-d:'Syne',sans-serif;--font-b:'DM Sans',sans-serif;--ease:cubic-bezier(.16,1,.3,1)}
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:var(--font-b);background:var(--bg);color:var(--text);min-height:100vh;-webkit-font-smoothing:antialiased}
    .wrap{max-width:680px;margin:0 auto;padding:3rem 1.5rem}
    .back{display:inline-flex;align-items:center;gap:.5rem;font-size:.875rem;color:var(--text-2);text-decoration:none;margin-bottom:2rem;padding:.5rem .875rem;border:1px solid var(--border);border-radius:var(--radius);transition:all .2s}
    .back:hover{color:var(--text);border-color:var(--border-hover)}
    h1{font-family:var(--font-d);font-size:1.75rem;font-weight:800;margin-bottom:2rem}
    .card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-xl);padding:2rem}
    .form-group{margin-bottom:1.25rem}
    .form-label{display:block;font-size:.8125rem;font-weight:600;color:var(--text-2);margin-bottom:.5rem;letter-spacing:.04em;text-transform:uppercase}
    .form-input,.form-select,.form-textarea{width:100%;padding:.75rem 1rem;background:var(--bg-3);border:1px solid var(--border);border-radius:var(--radius);color:var(--text);font-family:var(--font-b);font-size:.9375rem;outline:none;transition:all .2s}
    .form-input:focus,.form-select:focus,.form-textarea:focus{border-color:var(--accent);box-shadow:0 0 0 3px var(--accent-dim)}
    .form-select{-webkit-appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%238B92A5'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right .625rem center;background-size:14px;padding-right:2rem;cursor:pointer}
    .form-textarea{resize:vertical;min-height:120px;line-height:1.6}
    .row-2{display:grid;grid-template-columns:1fr 1fr;gap:1rem}
    .img-upload{border:2px dashed var(--border);border-radius:var(--radius);padding:2rem;text-align:center;cursor:pointer;transition:all .2s;position:relative}
    .img-upload:hover{border-color:var(--accent);background:var(--accent-dim)}
    .img-upload input{position:absolute;inset:0;opacity:0;cursor:pointer;width:100%;height:100%}
    .preview-box{margin-top:1rem;display:none}
    .preview-box img{max-width:150px;max-height:120px;border-radius:var(--radius);object-fit:cover;border:1px solid var(--border)}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:.5rem;padding:.875rem 2rem;font-family:var(--font-b);font-size:.9375rem;font-weight:700;border-radius:var(--radius);border:none;cursor:pointer;transition:all .2s}
    .btn-primary{background:var(--accent);color:#080A0F;box-shadow:0 0 20px rgba(0,212,255,.25)}
    .btn-primary:hover{transform:translateY(-1px);box-shadow:0 0 30px rgba(0,212,255,.4)}
    .btn-ghost{background:transparent;color:var(--text-2);border:1px solid var(--border)}
    .msg{padding:.875rem 1.125rem;border-radius:var(--radius);font-size:.875rem;font-weight:500;margin-bottom:1rem;border:1px solid transparent}
    .msg-error{background:var(--red-dim);color:var(--red);border-color:rgba(255,71,87,.2)}
    .msg-success{background:var(--green-dim);color:var(--green);border-color:rgba(0,229,160,.2)}
    .form-hint{font-size:.75rem;color:var(--text-3);margin-top:.375rem}    /* IMPORT Logo - Lightning bolt effect */
    .logo-mark,.admin-logo-mark,.login-mark{
      position:relative;
      overflow:hidden;
    }
    .logo-mark::after,.admin-logo-mark::after,.login-mark::after{
      content:'‚ö°';
      position:absolute;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      background:linear-gradient(135deg,#00D4FF 0%,#0099CC 100%);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      background-clip:text;
      font-size:inherit;
    }

  </style>
</head>
<body>
<div class="wrap">
  <a href="/admin" class="back">‚Üê –ù–∞–∑–∞–¥ –≤ –∞–¥–º–∏–Ω–∫—É</a>
  <h1>‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h1>
  <div class="card">
    <div id="msg"></div>
    <form id="form" enctype="multipart/form-data">
      <div class="form-group">
        <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ *</label>
        <input type="text" name="name" class="form-input" placeholder="–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä 36V 15Ah" required>
      </div>
      <div class="row-2">
        <div class="form-group">
          <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
          <select name="category" class="form-select" id="catSelect" required><option value="">‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ ‚Äî</option></select>
        </div>
        <div class="form-group">
          <label class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ</label>
          <input type="number" name="stock" class="form-input" value="0" min="0" placeholder="10">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ *</label>
        <textarea name="description" class="form-textarea" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ‚Ä¶" required></textarea>
      </div>
      <div class="row-2">
        <div class="form-group">
          <label class="form-label">–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ (‚ÇΩ) *</label>
          <input type="number" name="price" class="form-input" placeholder="1990" min="1" step="0.01" required>
        </div>
        <div class="form-group">
          <label class="form-label">–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å (‚ÇΩ)</label>
          <input type="number" name="cost_price" class="form-input" placeholder="1500" min="0" step="0.01">
          <div class="form-hint">–í–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –≤ –∞–¥–º–∏–Ω–∫–µ</div>
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">–•–∏—Ç –ø—Ä–æ–¥–∞–∂</label>
        <select name="featured" class="form-select">
          <option value="false">–ù–µ—Ç</option>
          <option value="true">‚≠ê –î–∞</option>
        </select>
      </div>
      <div class="form-group">
        <label class="form-label">–°—Ç–∞—Ç—É—Å —Ç–æ–≤–∞—Ä–∞</label>
        <div style="display:flex;gap:1.5rem;padding:.5rem 0">
          <label style="display:flex;align-items:center;gap:.5rem;cursor:pointer">
            <input type="checkbox" name="in_stock" value="true" style="width:18px;height:18px;cursor:pointer">
            <span style="font-size:.9375rem">‚úÖ –í –Ω–∞–ª–∏—á–∏–∏</span>
          </label>
          <label style="display:flex;align-items:center;gap:.5rem;cursor:pointer">
            <input type="checkbox" name="preorder" value="true" style="width:18px;height:18px;cursor:pointer">
            <span style="font-size:.9375rem">üì¶ –ü–æ –ø—Ä–µ–¥–∑–∞–∫–∞–∑—É</span>
          </label>
        </div>
        <div class="form-hint">–ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –æ–±–∞ —Å—Ç–∞—Ç—É—Å–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ</div>
      </div>
      <div class="form-group">
        <label class="form-label">–§–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞</label>
        <div class="img-upload" id="uploadArea">
          <input type="file" name="image_file" accept=".jpg,.jpeg,.png,.gif,.webp" onchange="preview(event)">
          <div id="ph"><div style="font-size:2.5rem;margin-bottom:.5rem">üì∏</div><div style="font-size:.875rem;color:var(--text-2)">–ù–∞–∂–º–∏—Ç–µ –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ</div><div style="font-size:.75rem;color:var(--text-3);margin-top:.25rem">JPG, PNG, GIF, WebP</div></div>
          <div class="preview-box" id="pbox"><img id="pimg" src="" alt=""><div style="font-size:.75rem;color:var(--text-3);margin-top:.5rem" id="pfname"></div></div>
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">‚Äî –∏–ª–∏ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
        <input type="url" name="image_url" class="form-input" placeholder="https://example.com/img.jpg">
        <div class="form-hint">–ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω —Ñ–∞–π–ª, URL –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è</div>
      </div>
      <div style="display:flex;gap:.75rem;margin-top:.5rem">
        <button type="submit" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button type="reset" class="btn btn-ghost" onclick="clearPrev()">–û—á–∏—Å—Ç–∏—Ç—å</button>
      </div>
    </form>
  </div>
</div>
<script>
  const token = sessionStorage.getItem('adminToken');
  if (!token) location.href = '/admin';

  async function loadCategories() {
    try {
      const r = await fetch('/api/categories');
      const { categories } = await r.json();
      const sel = document.getElementById('catSelect');
      sel.innerHTML = '<option value="">‚Äî –≤—ã–±–µ—Ä–∏—Ç–µ ‚Äî</option>' + categories.map(c => `<option value="${c.slug}">${c.emoji} ${c.name}</option>`).join('');
    } catch {}
  }
  loadCategories();

  function preview(event) {
    const file = event.target.files[0]; if (!file) return;
    const reader = new FileReader();
    reader.onload = e => { document.getElementById('ph').style.display='none'; document.getElementById('pbox').style.display='block'; document.getElementById('pimg').src=e.target.result; document.getElementById('pfname').textContent=file.name; };
    reader.readAsDataURL(file);
  }
  function clearPrev() { document.getElementById('ph').style.display=''; document.getElementById('pbox').style.display='none'; document.getElementById('pimg').src=''; }

  document.getElementById('form').addEventListener('submit', async e => {
    e.preventDefault();
    const msgEl = document.getElementById('msg');
    const formData = new FormData(e.target);
    
    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —á–µ–∫–±–æ–∫—Å—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
    if (!formData.get('in_stock')) formData.set('in_stock', 'false');
    if (!formData.get('preorder')) formData.set('preorder', 'false');
    
    try {
      const r = await fetch('/api/admin/products', { method:'POST', headers:{Authorization:`Bearer ${token}`}, body:formData });
      const d = await r.json();
      if (r.ok) { msgEl.innerHTML = '<div class="msg msg-success">‚úÖ –¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω! <a href="/admin" style="color:var(--green)">–ü–µ—Ä–µ–π—Ç–∏ –≤ –∞–¥–º–∏–Ω–∫—É ‚Üí</a></div>'; e.target.reset(); clearPrev(); }
      else msgEl.innerHTML = `<div class="msg msg-error">${d.detail||'–û—à–∏–±–∫–∞'}</div>`;
    } catch { msgEl.innerHTML = '<div class="msg msg-error">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è</div>'; }
  });
</script>
</body>
</html>
